<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Logic Core</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&family=JetBrains+Mono:wght@400;700&display=swap');

        :root {
            --bg-deep: #0f172a;
            --bg-card: rgba(30, 41, 59, 0.7);
            --accent: #10b981; /* Emerald Green */
            --accent-glow: rgba(16, 185, 129, 0.4);
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --border: rgba(255, 255, 255, 0.08);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background: var(--bg-deep);
            background-image: 
                radial-gradient(at 0% 0%, rgba(16, 185, 129, 0.15) 0px, transparent 50%),
                radial-gradient(at 100% 100%, rgba(56, 189, 248, 0.15) 0px, transparent 50%);
            color: var(--text-main);
            font-family: 'Space Grotesk', sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column; /* Stack chat on top of viz for mobile default, row for desktop */
            overflow: hidden;
        }

        /* --- DESKTOP LAYOUT --- */
        @media (min-width: 769px) {
            body { flex-direction: row; }
            .sidebar { width: 350px; border-right: 1px solid var(--border); border-bottom: none; }
            .main-stage { flex: 1; }
        }

        /* --- SIDEBAR (Chat) --- */
        .sidebar {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
            padding: 24px;
            z-index: 20;
            border-bottom: 1px solid var(--border);
            height: 40vh; /* Mobile Height */
        }
        @media (min-width: 769px) { .sidebar { height: 100vh; } }

        .logo {
            font-size: 1.25rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .logo-dot { width: 10px; height: 10px; background: var(--accent); border-radius: 50%; box-shadow: 0 0 10px var(--accent); }

        .chat-log {
            flex: 1;
            background: rgba(0,0,0,0.2);
            border-radius: 12px;
            border: 1px solid var(--border);
            margin-bottom: 20px;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .message {
            font-size: 0.9rem;
            line-height: 1.4;
            padding: 10px 14px;
            border-radius: 10px;
            max-width: 90%;
            animation: fadeIn 0.3s ease;
        }
        .msg-ai { background: rgba(16, 185, 129, 0.1); color: var(--accent); align-self: flex-start; border: 1px solid rgba(16, 185, 129, 0.2); }
        .msg-user { background: #334155; color: white; align-self: flex-end; }

        .input-group { position: relative; }
        .input-box {
            width: 100%;
            background: #1e293b;
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 15px;
            padding-right: 50px;
            color: white;
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1rem;
            outline: none;
            transition: all 0.2s;
        }
        .input-box:focus { border-color: var(--accent); box-shadow: 0 0 0 2px var(--accent-glow); }
        
        .send-btn {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--accent);
            border: none;
            width: 32px; height: 32px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #0f172a;
            transition: transform 0.2s;
        }
        .send-btn:hover { transform: translateY(-50%) scale(1.1); }
        .send-btn:disabled { background: #64748b; cursor: not-allowed; }

        /* --- MAIN STAGE (Visualizer) --- */
        .main-stage {
            position: relative;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            height: 60vh; /* Mobile height */
        }
        @media (min-width: 769px) { .main-stage { height: 100vh; } }

        /* Diagram Container - Horizontal Scroll */
        .diagram-scroll-area {
            flex: 1;
            display: flex;
            align-items: center;
            overflow-x: auto; /* Horizontal Scroll */
            overflow-y: hidden;
            scroll-behavior: smooth;
            padding: 0 40px; /* Padding for desktop */
            
            /* Mobile Snap */
            scroll-snap-type: x mandatory;
            
            /* Hide Scrollbar */
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .diagram-scroll-area::-webkit-scrollbar { display: none; }

        .diagram-track {
            display: flex;
            align-items: center;
            gap: 40px; /* Gap between blocks */
            position: relative;
            min-width: max-content; /* Ensure it grows horizontally */
            padding: 50px 0; /* Vertical breathing room */
        }

        /* Blocks */
        .node {
            width: 160px;
            height: 180px;
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            backdrop-filter: blur(12px);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 5;
            
            /* Snap alignment */
            scroll-snap-align: center;
        }

        .node.active {
            border-color: var(--accent);
            background: rgba(16, 185, 129, 0.1);
            box-shadow: 0 0 30px var(--accent-glow);
            transform: scale(1.05);
        }

        .node-icon { font-size: 2.5rem; margin-bottom: 15px; opacity: 0.8; }
        .node-title { 
            font-size: 0.85rem; 
            font-weight: 700; 
            text-transform: uppercase; 
            letter-spacing: 1px;
            color: var(--text-muted);
        }
        .node.active .node-title { color: white; }

        /* Description text inside block */
        .node-desc {
            font-size: 0.7rem;
            text-align: center;
            margin-top: 8px;
            padding: 0 10px;
            color: #64748b;
            opacity: 0;
            transform: translateY(5px);
            transition: all 0.3s;
        }
        .node.active .node-desc { opacity: 1; transform: translateY(0); }

        /* Arrows */
        .connector {
            color: #475569;
            font-size: 1.5rem;
            animation: bounceRight 2s infinite;
        }

        /* The Ball (Data Packet) */
        .data-orb {
            position: absolute;
            top: 0; left: 0;
            width: 20px; height: 20px;
            background: white;
            border-radius: 50%;
            z-index: 50;
            box-shadow: 0 0 20px var(--accent);
            display: none;
            pointer-events: none;
            transition: left 0.8s ease-in-out, top 0.8s ease-in-out;
        }
        .data-orb::after {
            content: ''; position: absolute; inset: -50%;
            border-radius: 50%;
            background: radial-gradient(circle, var(--accent-glow), transparent 70%);
            animation: pulse 1s infinite;
        }

        /* --- TERMINAL (Bottom) --- */
        .terminal-overlay {
            height: 140px;
            background: #0b101b;
            border-top: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            font-family: 'JetBrains Mono', monospace;
            z-index: 30;
        }

        .term-bar {
            padding: 8px 16px;
            background: rgba(255,255,255,0.03);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            font-size: 0.75rem;
            color: #64748b;
            text-transform: uppercase;
        }

        .term-content {
            padding: 16px;
            flex: 1;
            overflow-y: auto;
            color: #e2e8f0;
            font-size: 0.9rem;
        }
        
        .log-entry { margin-bottom: 6px; display: flex; opacity: 0; animation: slideUp 0.3s forwards; }
        .log-time { color: #475569; margin-right: 12px; }
        .log-txt { flex: 1; }
        .log-txt.active { color: var(--accent); text-shadow: 0 0 10px var(--accent-glow); }

        /* --- ANIMATIONS --- */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideUp { from { opacity: 0; transform: translateX(-10px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes pulse { 0% { transform: scale(0.8); opacity: 0.8; } 100% { transform: scale(1.5); opacity: 0; } }
        @keyframes bounceRight { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(5px); } }

        /* --- MOBILE TWEAKS --- */
        @media (max-width: 768px) {
            .diagram-scroll-area {
                padding: 0 50vw 0 50vw; /* Huge padding to allow centering first/last items */
            }
            .diagram-track {
                padding: 0;
                gap: 80px; /* More space between blocks on mobile for focus */
            }
            .node {
                /* On mobile, center the active block */
                scroll-snap-align: center;
                min-width: 200px; /* Wider cards on mobile */
                height: 220px;
            }
            .sidebar { padding: 15px; }
            .logo { margin-bottom: 10px; font-size: 1rem; }
            .terminal-overlay { height: 120px; }
        }

    </style>
</head>
<body>

    <!-- LEFT: CHAT -->
    <div class="sidebar">
        <div class="logo">
            <div class="logo-dot"></div>
            <span>AI CORE VISUALIZER</span>
        </div>
        
        <div class="chat-log" id="chatLog">
            <div class="message msg-ai">System Online. Enter a prompt to visualize the neural pathway.</div>
        </div>

        <div class="input-group">
            <input type="text" class="input-box" id="userInput" placeholder="Ask something..." autocomplete="off">
            <button class="send-btn" id="sendBtn" onclick="runSimulation()">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"></path>
                </svg>
            </button>
        </div>
    </div>

    <!-- RIGHT: VISUALIZER -->
    <div class="main-stage">
        
        <!-- Scrolling Diagram -->
        <div class="diagram-scroll-area" id="scrollContainer">
            <div class="diagram-track" id="track">
                
                <!-- The Moving Ball -->
                <div class="data-orb" id="orb"></div>

                <!-- 1. Input -->
                <div class="node" id="node-0">
                    <div class="node-icon">‚å®Ô∏è</div>
                    <div class="node-title">Input</div>
                    <div class="node-desc">Receiving text</div>
                </div>

                <div class="connector">‚Üí</div>

                <!-- 2. Tokenizer -->
                <div class="node" id="node-1">
                    <div class="node-icon">üî¢</div>
                    <div class="node-title">Tokenize</div>
                    <div class="node-desc">Text to ID</div>
                </div>

                <div class="connector">‚Üí</div>

                <!-- 3. Memory -->
                <div class="node" id="node-2">
                    <div class="node-icon">üíæ</div>
                    <div class="node-title">Context</div>
                    <div class="node-desc">Retreiving History</div>
                </div>

                <div class="connector">‚Üí</div>

                <!-- 4. Model -->
                <div class="node" id="node-3">
                    <div class="node-icon">üß†</div>
                    <div class="node-title">Model</div>
                    <div class="node-desc">Neural Processing</div>
                </div>

                <div class="connector">‚Üí</div>

                <!-- 5. Output -->
                <div class="node" id="node-4">
                    <div class="node-icon">üí¨</div>
                    <div class="node-title">Output</div>
                    <div class="node-desc">Generating Text</div>
                </div>

            </div>
        </div>

        <!-- Terminal -->
        <div class="terminal-overlay">
            <div class="term-bar">
                <span>Process Log</span>
                <span id="statusBadge" style="color: var(--accent);">IDLE</span>
            </div>
            <div class="term-content" id="terminal">
                <div class="log-entry">
                    <span class="log-time">00:00</span>
                    <span class="log-txt">Waiting for input stream...</span>
                </div>
            </div>
        </div>

    </div>

    <script>
        let isProcessing = false;

        function log(msg, isActive = false) {
            const term = document.getElementById('terminal');
            const now = new Date();
            const timeStr = `${now.getHours()}:${now.getMinutes()}:${now.getSeconds()}`;
            
            const div = document.createElement('div');
            div.className = 'log-entry';
            div.innerHTML = `
                <span class="log-time">${timeStr}</span>
                <span class="log-txt ${isActive ? 'active' : ''}">${msg}</span>
            `;
            term.appendChild(div);
            term.scrollTop = term.scrollHeight;
        }

        async function runSimulation() {
            if (isProcessing) return;
            
            const input = document.getElementById('userInput');
            const text = input.value.trim();
            if (!text) return;

            isProcessing = true;
            document.getElementById('sendBtn').disabled = true;
            document.getElementById('statusBadge').innerText = "RUNNING";

            // Add Chat Msg
            const chat = document.getElementById('chatLog');
            chat.innerHTML += `<div class="message msg-user">${text}</div>`;
            chat.scrollTop = chat.scrollHeight;

            // Clear logs
            document.getElementById('terminal').innerHTML = '';

            // --- STEP 1: INPUT ---
            await activateNode(0);
            log(`Input received: "${text}"`, true);
            await wait(1200);

            // --- STEP 2: TOKENIZE ---
            await activateNode(1);
            log("Breaking text into tokens...");
            await wait(1500);

            // --- STEP 3: CONTEXT ---
            await activateNode(2);
            log("Loading conversation history...");
            await wait(1500);

            // --- STEP 4: MODEL ---
            await activateNode(3);
            log("Processing neural layers...");
            // Extra thinking time
            for(let i=0; i<3; i++) {
                await wait(500);
                log("Calculating probability...");
            }
            await wait(500);

            // --- STEP 5: OUTPUT ---
            await activateNode(4);
            log("Decoding answer...");
            await wait(1000);

            // Finish
            const response = mockResponse(text);
            chat.innerHTML += `<div class="message msg-ai">${response}</div>`;
            chat.scrollTop = chat.scrollHeight;
            
            finish();
        }

        function mockResponse(text) {
            const t = text.toLowerCase();
            if (t.includes('hello')) return "Hello! Ready to analyze.";
            if (t.includes('code')) return "Here is a Python snippet: print('Secure')";
            return "Analysis complete. Logic path visualized.";
        }

        async function finish() {
            // Hide Orb
            const orb = document.getElementById('orb');
            orb.style.opacity = '0';
            setTimeout(() => orb.style.display = 'none', 500);

            // Reset Nodes
            for(let i=0; i<5; i++) {
                document.getElementById(`node-${i}`).classList.remove('active');
            }

            log("Process Complete.", true);
            document.getElementById('sendBtn').disabled = false;
            document.getElementById('userInput').value = '';
            document.getElementById('statusBadge').innerText = "IDLE";
            isProcessing = false;
        }

        function activateNode(index) {
            return new Promise(resolve => {
                const node = document.getElementById(`node-${index}`);
                const container = document.getElementById('scrollContainer');
                const orb = document.getElementById('orb');
                const track = document.getElementById('track');

                // 1. Deactivate previous
                if (index > 0) document.getElementById(`node-${index-1}`).classList.remove('active');

                // 2. Auto-Scroll Logic (Crucial for Mobile)
                // Center the target node in the scroll view
                const nodeLeft = node.offsetLeft;
                const nodeWidth = node.offsetWidth;
                const containerWidth = container.clientWidth;
                
                // Calculate scroll position to center element
                const scrollPos = nodeLeft - (containerWidth / 2) + (nodeWidth / 2);
                
                container.scrollTo({
                    left: scrollPos,
                    behavior: 'smooth'
                });

                // 3. Move Orb (Must account for track position relative to scroll parent)
                // Note: Orb is absolute inside 'track', which moves with scroll. 
                // We just need its offset relative to the track start.
                const targetLeft = node.offsetLeft + (node.offsetWidth / 2) - 10; // -10 is half orb size
                const targetTop = node.offsetTop + (node.offsetHeight / 2) - 10;

                if (orb.style.display === 'none' || orb.style.display === '') {
                    // Initial Appear
                    orb.style.display = 'block';
                    orb.style.opacity = '1';
                    orb.style.left = targetLeft + 'px';
                    orb.style.top = targetTop + 'px';
                    node.classList.add('active');
                    resolve();
                } else {
                    // Glide
                    orb.style.left = targetLeft + 'px';
                    orb.style.top = targetTop + 'px';
                    
                    // Wait for glide
                    setTimeout(() => {
                        node.classList.add('active');
                        resolve();
                    }, 800);
                }
            });
        }

        function wait(ms) { return new Promise(r => setTimeout(r, ms)); }
    </script>
</body>
</html>
